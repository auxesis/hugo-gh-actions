name: Screenshot PR changes

on:
  push:
    branches: [ master ]
  pull_request:
    branches: [ master ]

jobs:
  build:
    name: Build the website
    runs-on: ubuntu-latest
    steps:
    - name: ğŸ›’ Checkout repo
      uses: actions/checkout@v2
      with:
        repository: ${{ secrets.WEBSITE_REPO }}
        token: ${{ secrets.ACCESS_TOKEN }}
        submodules: true
#    - name: ğŸ›  Build the Docker image
#      run: hugo server
#    - name: â¬†ï¸ Upload the artifact
#      uses: actions/upload-artifact@v2
#      with:
#        name: website
#        path: public/

  screenshot:
    name: Screenshot the website
    needs: build
    runs-on: ubuntu-latest
    services:
      nginx:
        image: nginx
        # Map port 8080 on the Docker host to port 80 on the nginx container
        ports:
          - 8080:80
    steps:
    - name: ğŸ“¸ Screenshot Website
      uses: swinton/screenshot-website@v1.0.0
      with:
        source: http://localhost/
        destination: screenshot.png
        full-page: true
